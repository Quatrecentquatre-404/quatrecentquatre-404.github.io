<!doctype html>
<html lang="en" style="height: 100%;">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Useful tools | Webhook Sender</title>
    <link rel="stylesheet" href="./assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="./assets/css/fontawesome.css">
    <link rel="stylesheet" href="./assets/css/style.css">
    <link rel="shortcut icon" href="./assets/img/logo.png">
</head>

<body class="bg-primary" style="height: 100%; display: flex; flex-direction: column;">
    <div style="flex: 1 0 auto;">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <a class="navbar-brand" href="index.html">Useful Tools</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse"
                data-document.getElementById="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Tools
                        </a>
                        <div class="dropdown-menu bg-dark" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item text-light" href="webhook.html">Webhook Sender</a>
                            <a class="dropdown-item text-light" href="token_checker.html">Tokens Checker</a>
                            <a class="dropdown-item text-light" href="token_joiner.html">Tokens Joiner</a>
                            <a class="dropdown-item text-light" href="token_friends.html">Token Friends</a>
                            <a class="dropdown-item text-light" href="base64.html">Base 64</a>
                        </div>
                    </li>
                </ul>

            </div>
        </nav>
        <main>
            <section class="container py-5">
                <div class="card bg-dark shadow-sm my-5">
                    <div class="card-header text-light">
                        <h3 class="card-title" style="display: inline;">Webhook Sender</h3>
                    </div>
                    <div class="card-body bg-dark text-light">
                        <div class="form-group">
                            <legend>Webhook</legend>
                            <div class="input-group">
                                <input id="webhook-url" type="text" class="text-light form-control"
                                    placeholder="https://discord.com/api/webhooks/WEBHOOK_ID/WEBHOOK_TOKEN">
                            </div>
                        </div>
                        <div id="webhook-form" class="py-2">
                            <div class="form-group pb-3">
                                <legend>Unembedded</legend>
                                <textarea id="content" rows="5" class="text-light form-control"
                                    placeholder="Content"></textarea>
                            </div>
                            <legend>Basics</legend>
                            <div class="form-row">
                                <div class="form-group col-10">
                                    <input id="embed-title" type="text" class="text-light form-control"
                                        placeholder="Title">
                                </div>
                                <div class="form-group col-2">
                                    <input id="embed-color" type="color" class="text-light form-control"
                                        value="#FFFFFE">
                                </div>
                            </div>
                            <div class="form-group">
                                <textarea id="embed-description" rows="5" class="text-light form-control"
                                    placeholder="Description"></textarea>
                            </div>
                            <div class="form-group pb-3">
                                <input id="embed-url" type="url" class="text-light form-control" placeholder="Url">
                            </div>
                            <legend>Author</legend>
                            <div class="form-row">
                                <div class="form-group col">
                                    <input id="embed-author-name" type="text" class="text-light form-control"
                                        placeholder="Name">
                                </div>
                                <div class="form-group col">
                                    <input id="embed-author-icon_url" type="url" class="text-light form-control"
                                        placeholder="Icon URL">
                                </div>
                            </div>
                            <div class="form-group pb-3">
                                <input id="embed-author-url" type="text" class="text-light form-control"
                                    placeholder="URL">
                            </div>
                            <legend>Images</legend>
                            <div class="form-group">
                                <input id="embed-thumbnail-url" type="url" class="text-light form-control"
                                    placeholder="Thumbnail URL">
                            </div>
                            <div class="form-group pb-3">
                                <input id="embed-image-url" type="url" class="text-light form-control"
                                    placeholder="Image URL">
                            </div>
                            <legend>Footer</legend>
                            <div class="form-row">
                                <div class="form-group col">
                                    <input id="embed-footer-text" type="text" class="text-light form-control"
                                        placeholder="Text">
                                </div>
                                <div class="form-group col">
                                    <input id="embed-timestamp" type="datetime-local" class="text-light form-control"
                                        step="0.001">
                                </div>
                            </div>
                            <div class="form-group pb-3">
                                <input id="embed-footer-icon_url" type="url" class="text-light form-control"
                                    placeholder="Icon URL">
                            </div>
                            <br>
                            <div id="submit-alerts" class="my-3"></div>
                            <button class="btn btn-primary float-right" onclick="treat_webhook_send(document)">Send
                                Embed</button>
                        </div>
                    </div>
                </div>

                <script src="./scripts/request.js"></script>
                <script src="./scripts/alert.js"></script>
                <script src="./scripts/embed.js"></script>
                <script src="./scripts/webhook.js"></script>
                <script src="./scripts/get_inputs.js"></script>
                <script>
                    function charge_webhook(
                        payload = {
                            webhook_url: null,
                            content: null,
                            title: null,
                            color: null,
                            description: null,
                            url: null,
                            author_name: null,
                            author_icon_url: null,
                            author_url: null,
                            thumbnail: null,
                            image: null,
                            footer_text: null,
                            footer_icon_url: null,
                            timestamp: null,
                        }
                    ) {
                        const paths = payload.webhook_url.split("/").filter((e) => e !== "")
                        if (paths.length >= 2) {
                            const embed = new Embed()
                                .setTitle(payload.title)
                                .setDescription(payload.description)
                                .setTimestamp(payload.timestamp)
                                .setImage(payload.image)
                                .setThumbnail(payload.thumbnail)
                                .setFooter(payload.footer_text, payload.footer_icon_url)
                                .setColor(payload.color)
                                .setURL(payload.url)
                                .setAuthor(
                                    payload.author_name,
                                    payload.author_url,
                                    payload.author_icon_url
                                ),
                                webhook_token = paths[paths.length - 1],
                                webhook_id = paths[paths.length - 2],
                                webhook = new Webhook(webhook_id, webhook_token)
                            return webhook.send_message({
                                content: payload.content,
                                embeds: [embed],
                            })
                        } else {
                            return {
                                message: "Invalid Webhook Token",
                                code: "50027",
                            }
                        }
                        return null
                    }

                </script>
                <script src="./scripts/treat.js"></script>
        </main>
    </div>
</body>

</html>